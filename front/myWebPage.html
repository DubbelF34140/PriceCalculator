<!DOCTYPE html>
<html lang="en">
<head>
  <title>Price Calculator</title>
  <meta charset="utf-8"> 
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="myZebPage.css">
  <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js"></script>  
</head>
<body>

<div class="api-indicator">
  <span class="api-status" id="apiStatus" title="API status"></span>
</div>

<div class="container my-5">
  <div class="text-center">
    <h1 class="display-4">How much to charge?</h1>
    <p class="lead">If you were a freelance web designer, how much should you charge for a website? Fill out the form and find out!</p>
  </div>
</div>

<div class="container">
  <div class="card shadow-sm">
    <div class="card-body">
      <form id="budget">
        <div class="form-group">
          <label for="salary">What annual salary seems suitable for you?</label>
          <input type="number" id="salary" name="salary" class="form-control" placeholder="e.g. 50000" required>
        </div>

        <div class="form-group">
          <label for="days">How many days do you think it will take you to make the website?</label>
          <input type="number" id="days" name="days" class="form-control" placeholder="e.g. 10" required>
        </div>

        <button type="button" id="submit" class="btn btn-primary btn-lg btn-block">Calculate your price!</button>

        <div class="mt-4">
          <h4 class="text-center">Estimated Price:</h4>
          <p id="finalPrice" class="text-center font-weight-bold h4 text-success"></p>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  $('#submit').click(handleClick);

  function handleClick() {
    var salary = $('#salary').val();
    var days = $('#days').val();

    var url = "/api/getPrice?salary=" + salary + "&days=" + days;
    console.log("Requesting: " + url);

    $.ajax({
      url: url,
      success: function(finalPrice) {
        $("#finalPrice").html("Â£" + finalPrice);
      }
    });

    return false;
  }

  function checkApiStatus() {
    $.ajax({
      url: "/api",
      success: function(response) {
        if (response.trim() === "Yes we have an API now") {
          $("#apiStatus").css("background-color", "green");
        } else {
          $("#apiStatus").css("background-color", "red");
        }
      },
      error: function() {
        $("#apiStatus").css("background-color", "red");
      }
    });
  }

  $(document).ready(function() {
    checkApiStatus();
  });
</script>

</body>
</html>